OPENCODE REAL ARCHITECTURE ANALYSIS
====================================

üì° BACKEND SERVER (OpenCode Asli):
- Framework: Hono HTTP Server (lightweight)
- Default Port: 4096
- Protocol: HTTP REST API + OpenAPI 3.1 Spec
- Auth: HTTP Basic Auth (username/password)
- Real-time: Server-Sent Events (SSE)

üîå API ENDPOINTS (Total: 50+ endpoints):

1. GLOBAL:
   GET /global/health - Health check
   GET /global/event - SSE event stream

2. PROJECT:
   GET /project - List all projects
   GET /project/current - Current project

3. SESSIONS (Core):
   GET  /session - List sessions
   POST /session - Create session
   GET  /session/:id - Get session
   POST /session/:id/message - Send message
   POST /session/:id/shell - Run shell command
   POST /session/:id/command - Execute slash command
   POST /session/:id/abort - Abort running session
   GET  /session/:id/diff - Get file diffs

4. MESSAGES:
   GET  /session/:id/message - List messages
   POST /session/:id/message - Send & wait response
   POST /session/:id/prompt_async - Send async
   GET  /session/:id/message/:messageID - Get message

5. FILES:
   GET /file?path=<path> - List files
   GET /file/content?path=<p> - Read file
   GET /find?pattern=<pat> - Search in files
   GET /find/file?query=<q> - Find files

6. PROVIDERS:
   GET /provider - List providers
   GET /provider/auth - Auth methods
   POST /provider/:id/oauth/authorize - OAuth

7. TOOLS:
   GET /experimental/tool/ids - List tool IDs
   GET /experimental/tool - List with schemas

8. LSP/MCP:
   GET /lsp - LSP server status
   GET /mcp - MCP server status
   POST /mcp - Add MCP server

9. COMMANDS:
   GET /command - List all commands

10. TUI CONTROL:
    POST /tui/append-prompt - Append text
    POST /tui/submit-prompt - Submit
    POST /tui/execute-command - Execute

11. AUTH:
    PUT /auth/:id - Set credentials

12. EVENTS:
    GET /event - SSE stream

‚öôÔ∏è HOW IT WORKS:
1. Run: opencode serve [--port 4096]
2. Server starts on localhost:4096
3. TUI (Terminal UI) connects as client
4. Server exposes OpenAPI spec at /doc
5. SDK auto-generated from spec
6. Multiple clients can connect
7. Events streamed via SSE

üîê AUTHENTICATION:
- Set OPENCODE_SERVER_PASSWORD
- Username: opencode (default)
- HTTP Basic Auth headers
- Or OPENCODE_SERVER_USERNAME to override

üéØ WORKFLOW:
1. Create session: POST /session
2. Send message: POST /session/:id/message
3. Server processes via LLM
4. Tools executed (file, shell, etc.)
5. Response streamed via SSE
6. Files modified
7. Diffs tracked

üíª COMMANDS SUPPORTED:
- Shell commands via /session/:id/shell
- Slash commands via /session/:id/command
- File operations (read/write/search)
- Git operations
- LSP integration
- MCP server integration

üö´ KETERBATASAN ANDROID APP SAYA:
‚ùå Tidak implementasi lengkap 50+ endpoints
‚ùå Tidak ada SSE event handling
‚ùå Tidak ada session management
‚ùå Tidak ada file diff tracking
‚ùå Tidak ada LSP/MCP integration
‚ùå Tidak ada provider OAuth flow
‚ùå Tidak ada command registry
‚ùå Tidak ada real-time streaming

‚úÖ YANG BISA DILAKUKAN:
‚úì Connect ke OpenCode server yang sudah running
‚úì Basic HTTP API calls
‚úì Kirim pesan & terima response
‚úì List files & baca konten
‚úì Eksekusi shell commands
‚úì Session management (basic)

üéØ UNTUK 100% SEPERTI OPENCODE:
Butuh implementasi lengkap:
1. Semua 50+ API endpoints
2. SSE event stream handler
3. Session lifecycle management
4. File watcher & diff tracking
5. Tool execution engine
6. Provider authentication
7. Command registry system
8. LSP client integration
9. MCP client integration
10. Real-time collaboration

üì± ANDROID APP STATUS:
- UI: 90% mirip (bagus)
- Backend: 10% (cuma prototype)
- Butuh connect ke OpenCode server asli untuk jadi 100%

KESIMPULAN:
OpenCode itu kompleks! Bukan cuma chat bot, tapi:
- Full IDE backend
- File system integration
- Git integration  
- LSP (Language Server Protocol)
- MCP (Model Context Protocol)
- Tool execution engine
- Session management
- Real-time streaming
- Multi-provider support

Android app saya baru UI-nya saja. Untuk 100% functional,
harus connect ke OpenCode server yang running, atau
re-implementasi semua backend logic (berbulan-bulan kerjaan).
